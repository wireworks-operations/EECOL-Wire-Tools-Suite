<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tape Measure Converter — Inches ⇄ mm ⇄ cm ⇄ Feet&Inches</title>
./tape-scale.js</script>
<style>
  :root { color-scheme: dark; }
  body { margin:0; padding:1rem; font-family:system-ui, Segoe UI, Inter, Roboto, Arial, sans-serif; background:#0b0c0f; color:#e6edf3; }
  .card { max-width: 980px; margin: 0 auto; background: linear-gradient(180deg,#11141a,#0d1218); border:1px solid #1f2937; border-radius:12px; padding:1rem 1rem 1.25rem; box-shadow: 0 10px 30px rgba(0,0,0,.35); }
  h1 { font-size: 1.15rem; margin: 0 0 .75rem }
  .grid { display:grid; gap:.75rem; grid-template-columns: repeat(6, minmax(0,1fr)); }
  .grid > div { grid-column: span 3; }
  .grid > div.wide { grid-column: 1 / -1; }
  .field { background:#0f141b; border:1px solid #223040; border-radius:10px; padding:.75rem; }
  .field label { display:block; color:#a9b6c3; font-size:.9rem; margin-bottom:.35rem }
  input[type="text"], input[type="number"] { width:100%; padding:.55rem .65rem; border-radius:8px; border:1px solid #314155; background:#0b1320; color:#e6edf3; font-size:1rem; }
  .row { display:flex; gap:.5rem; align-items:center; flex-wrap:wrap; }
  .chip { font:600 12px/1 system-ui; letter-spacing:.2px; padding:.3rem .5rem; border-radius:6px; border:1px solid #2c3b4f; color:#9fb1c1 }
  .out { background:#0c1119; border:1px dashed #2b3a4d; border-radius:10px; padding:.75rem; display:grid; gap:.4rem; grid-template-columns: repeat(2, minmax(0,1fr)); }
  .kv { color:#cfe1f6 }
  .help { color:#9fb1c1; font-size:.9rem; margin-top:.35rem }
  .actions { display:flex; gap:.5rem; flex-wrap:wrap; }
  button { background:#1b2a3a; border:1px solid #2f3e52; color:#e9f6ff; border-radius:8px; padding:.5rem .7rem; cursor:pointer; font-weight:700 }
  .ruler { margin-top:.75rem; border-radius:12px; overflow:hidden; border:1px solid #253244; }
  .toggle { display:flex; gap:.5rem; align-items:center; flex-wrap:wrap; }
  select { background:#0b1320; color:#e6edf3; border:1px solid #314155; border-radius:8px; padding:.45rem .55rem; }
</style>
</head>
<body>
  <div class="card">
    <h1>Dynamic Conversion Panel — Inches ⇄ Millimeters ⇄ Centimeters ⇄ Feet & Inches</h1>

    <div class="grid">
      <div class="field">
        <label for="inInput">Inches (fraction or decimal)</label>
        <input id="inInput" type="text" placeholder='5/16  |  1 5/16  |  1-5/16  |  0.625' autocomplete="off">
        <div class="help">Fractions like <code>1 7/8</code> or <code>3/32</code> are accepted.</div>
      </div>

      <div class="field">
        <label for="fiInput">Feet & Inches</label>
        <input id="fiInput" type="text" placeholder=`5' 3 1/2"  |  5ft 3.5in  |  5'` autocomplete="off">
        <div class="help">Use <code>'</code> for feet and <code>"</code> for inches (fractions allowed).</div>
      </div>

      <div class="field">
        <label for="mmInput">Millimeters</label>
        <input id="mmInput" type="number" step="0.001" placeholder="15.875" inputmode="decimal" autocomplete="off">
      </div>

      <div class="field">
        <label for="cmInput">Centimeters</label>
        <input id="cmInput" type="number" step="0.001" placeholder="1.5875" inputmode="decimal" autocomplete="off">
      </div>

      <div class="field wide">
        <div class="row">
          <span class="chip">Rounding: nearest 1/16″ (for inch outputs)</span>
          <span class="chip" id="err" style="display:none; border-color:#6b2f2f; color:#ffb4b4">Invalid input</span>
          <div class="toggle" style="margin-left:auto">
            <label>Metric row:</label>
            <select id="metricUnitSel">
              <option value="mm">mm</option>
              <option value="cm">cm</option>
            </select>
            <label>Feet markers:</label>
            <select id="feetModeSel">
              <option value="auto">auto</option>
              <option value="on">on</option>
              <option value="off">off</option>
            </select>
          </div>
        </div>

        <div class="out" style="margin-top:.5rem">
          <div><strong>Inches (decimal):</strong> <span class="kv" id="outInDec">–</span></div>
          <div><strong>Millimeters:</strong> <span class="kv" id="outMM">–</span></div>
          <div><strong>Inches (nearest 1/16″):</strong> <span class="kv" id="outInFrac">–</span></div>
          <div><strong>Centimeters:</strong> <span class="kv" id="outCM">–</span></div>
          <div><strong>Feet & Inches (1/16″):</strong> <span class="kv" id="outFI">–</span></div>
          <div><strong>Δ to rounded (mm):</strong> <span class="kv" id="outDelta">–</span></div>
        </div>

        <div class="help">The marker shows your measurement’s position along the current inch (panel ruler is set to 1″ span for fidelity).</div>
      </div>

      <div class="wide ruler">
        <tape-scale id="r"
                    inches="1"
                    metric="true"
                    metric-unit="mm"
                    mode="both"
                    mm-label-step="5"
                    cm-label-step="0.5"
                    imperial-feet="off"
                    height="200"
                    marker="0"></tape-scale>
      </div>

      <div class="wide actions">
        <button id="btnCopy">Copy results</button>
        <button id="btnReset">Reset</button>
      </div>
    </div>
  </div>

<script>
  // ---------- Helpers ----------
  const gcd = (a,b)=>b?gcd(b,a%b):Math.abs(a);

  function parseInches(s){
    if (!s || !String(s).trim()) return NaN;
    s = String(s).trim().toLowerCase();

    // support "15.875 mm" or "1.5875 cm"
    if (/\bmm\b/.test(s)) {
      const mm = parseFloat(s.replace(/mm/,'').trim());
      return isFinite(mm) ? (mm/25.4) : NaN;
    }
    if (/\bcm\b/.test(s)) {
      const cm = parseFloat(s.replace(/cm/,'').trim());
      return isFinite(cm) ? (cm/2.54) : NaN;
    }
    if (/[″"]$/.test(s) || /\bin\b$/.test(s)) s = s.replace(/[″"]|in\b/g,'').trim();

    s = s.replace(/-/g,' '); // "1-5/16" → "1 5/16"
    const parts = s.split(/\s+/).filter(Boolean);
    let total = 0;
    if (parts.length===1){
      if (parts[0].includes('/')){
        const [n,d]=parts[0].split('/').map(Number);
        if (!isFinite(n)||!isFinite(d)||d===0) return NaN;
        total = n/d;
      } else {
        total = Number(parts[0]);
      }
    } else if (parts.length===2){
      const whole = Number(parts[0]);
      const [n,d]=parts[1].split('/').map(Number);
      if (!isFinite(whole)||!isFinite(n)||!isFinite(d)||d===0) return NaN;
      total = whole + n/d;
    } else { return NaN; }
    return isFinite(total) ? total : NaN;
  }

  function parseFeetInches(s){
    if (!s || !String(s).trim()) return NaN;
    s = String(s).toLowerCase().trim();
    s = s.replace(/feet\b|foot\b|ft\b/g,"'").replace(/inches\b|inch\b|in\b/g,'"');
    // normalize 5'3 1/2" or 5' 3.5" etc.
    let feet = 0, inchStr = '';

    const mFeet = s.match(/(-?\d+)\s*'/);
    if (mFeet) {
      feet = parseInt(mFeet[1],10);
      s = s.replace(mFeet[0],'').trim();
    }
    const mIn = s.match(/([-\d\s./]+)\s*"?$/); // remaining inches part
    if (mIn) inchStr = mIn[1].trim();

    let inches = 0;
    if (inchStr){
      // support "A B/C", "B/C", "A", "A.B"
      inchStr = inchStr.replace(/-/g,' ');
      const parts = inchStr.split(/\s+/).filter(Boolean);
      if (parts.length===1){
        if (parts[0].includes('/')){
          const [n,d] = parts[0].split('/').map(Number);
          if (isFinite(n)&&isFinite(d)&&d!==0) inches = n/d;
          else return NaN;
        } else {
          inches = Number(parts[0]);
        }
      } else if (parts.length===2){
        const whole = Number(parts[0]);
        const [n,d]=parts[1].split('/').map(Number);
        if (isFinite(whole)&&isFinite(n)&&isFinite(d)&&d!==0) inches = whole + n/d;
        else return NaN;
      } else return NaN;
    }
    return feet*12 + inches;
  }

  function toFraction16(inches){
    const n = Math.round(inches*16), d=16, g=gcd(n,d);
    return { n:n/g, d:d/g, raw:n };
  }
  function toFeetInches(inches){
    const sign = inches<0?-1:1; inches=Math.abs(inches);
    let ft = Math.floor(inches/12);
    let rem = inches - ft*12;
    const wholeIn = Math.floor(rem);
    const frac = rem - wholeIn;
    const fr = toFraction16(frac);
    // handle 1.000″ after rounding
    if (fr.raw===16){
      if (wholeIn+1===12){ ft+=1; rem=0; }
      return { ft: ft + (wholeIn+1===12?1:0), inches: (wholeIn+1)%12, frac: '0', str: `${sign<0?'-':''}${ft+(wholeIn+1===12?1:0)}' ${0}″` };
    }
    const fracMap={'1/2':'½','1/4':'¼','3/4':'¾','1/8':'⅛','3/8':'⅜','5/8':'⅝','7/8':'⅞'};
    const key=`${fr.n}/${fr.d}`; const nice = fracMap[key] || key;
    const label = `${sign<0?'-':''}${ft}' ${wholeIn}${fr.raw?` ${nice}`:''}″`;
    return { ft, inches: wholeIn + fr.raw/16, frac:nice, str: label };
  }
  function fracStr(n,d){
    const map={'1/2':'½','1/4':'¼','3/4':'¾','1/8':'⅛','3/8':'⅜','5/8':'⅝','7/8':'⅞'};
    const g=gcd(n,d); n/=g; d/=g; const key=`${n}/${d}`;
    return (map[key]||key)+'″';
  }
  const fmt = (n,prec=4)=>Number(n.toFixed(prec)).toString();

  // ---------- DOM ----------
  const inInput  = document.getElementById('inInput');
  const fiInput  = document.getElementById('fiInput');
  const mmInput  = document.getElementById('mmInput');
  const cmInput  = document.getElementById('cmInput');

  const outInDec = document.getElementById('outInDec');
  const outMM    = document.getElementById('outMM');
  const outCM    = document.getElementById('outCM');
  const outInFrac= document.getElementById('outInFrac');
  const outFI    = document.getElementById('outFI');
  const outDelta = document.getElementById('outDelta');

  const metricUnitSel = document.getElementById('metricUnitSel');
  const feetModeSel   = document.getElementById('feetModeSel');

  const err = document.getElementById('err');
  const ruler = document.getElementById('r');

  let lastEditing = null; // 'in'|'mm'|'cm'|'fi'

  function setError(on){ err.style.display = on ? '' : 'none'; }

  function updateFromInches(inches, source='in'){
    if (!isFinite(inches)) { setError(true); return; }
    setError(false);

    const mm = inches*25.4;
    const cm = mm/10;
    const fr = toFraction16(inches);
    const inchesRounded = fr.raw/16;
    const deltaMM = (inchesRounded*25.4) - mm;
    const fi = toFeetInches(inches);

    outInDec.textContent = `${fmt(inches,4)}″`;
    outMM.textContent    = `${fmt(mm,3)} mm`;
    outCM.textContent    = `${fmt(cm,3)} cm`;
    outInFrac.textContent= fracStr(fr.n, fr.d);
    outFI.textContent    = fi.str;
    outDelta.textContent = (deltaMM===0? '0' : fmt(deltaMM,3)) + ' mm';

    if (source!=='mm') mmInput.value = fmt(mm,3);
    if (source!=='cm') cmInput.value = fmt(cm,3);
    if (source!=='in') inInput.value = fmt(inches,4);
    if (source!=='fi') fiInput.value = fi.str;

    // marker shows fractional part within current inch
    const fracPart = inches - Math.floor(inches);
    ruler.setAttribute('marker', String(fracPart));
  }

  // --- Events: inputs ---
  inInput.addEventListener('input', e=>{
    lastEditing='in';
    const v = parseInches(e.target.value);
    if (isNaN(v)) { setError(true); return; }
    updateFromInches(v,'in');
  });
  fiInput.addEventListener('input', e=>{
    lastEditing='fi';
    const v = parseFeetInches(e.target.value);
    if (isNaN(v)) { setError(true); return; }
    updateFromInches(v,'fi');
  });
  mmInput.addEventListener('input', e=>{
    lastEditing='mm';
    const mm = Number(e.target.value);
    if (!isFinite(mm)) { setError(true); return; }
    updateFromInches(mm/25.4,'mm');
  });
  cmInput.addEventListener('input', e=>{
    lastEditing='cm';
    const cm = Number(e.target.value);
    if (!isFinite(cm)) { setError(true); return; }
    updateFromInches((cm*10)/25.4,'cm');
  });

  // --- Unit toggles control the component display only ---
  metricUnitSel.addEventListener('change', ()=>{
    ruler.setAttribute('metric-unit', metricUnitSel.value);
  });
  feetModeSel.addEventListener('change', ()=>{
    ruler.setAttribute('imperial-feet', feetModeSel.value);
  });

  // --- Buttons ---
  document.getElementById('btnCopy').addEventListener('click', ()=>{
    const text = [
      `Inches (dec): ${outInDec.textContent}`,
      `Inches (nearest 1/16″): ${outInFrac.textContent}`,
      `Millimeters: ${outMM.textContent}`,
      `Centimeters: ${outCM.textContent}`,
      `Feet & Inches (1/16″): ${outFI.textContent}`,
      `Delta to rounded (mm): ${outDelta.textContent}`
    ].join('\n');
    navigator.clipboard.writeText(text).catch(()=>{});
  });
  document.getElementById('btnReset').addEventListener('click', ()=>{
    [inInput,fiInput,mmInput,cmInput].forEach(el=>el.value='');
    [outInDec,outMM,outCM,outInFrac,outFI,outDelta].forEach(el=>el.textContent='–');
    setError(false);
    ruler.setAttribute('marker','0');
  });

  // init
  updateFromInches(0,'in');
</script>
</body>
</html>